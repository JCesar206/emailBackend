CREATE DATABASE correo_app
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_unicode_ci;

USE correo_app;

CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  email VARCHAR(100) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE mails (
  id INT AUTO_INCREMENT PRIMARY KEY,
  sender_id INT NOT NULL,
  receiver_email VARCHAR(100) NOT NULL,
  subject VARCHAR(150) NOT NULL,
  body TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_sender
    FOREIGN KEY (sender_id)
    REFERENCES users(id)
    ON DELETE CASCADE
);

CREATE TABLE mail_attachments (
	id INT AUTO_INCREMENT PRIMARY KEY,
	mail_id INT NOT NULL,
	filename VARCHAR(255) NOT NULL,
	original_name VARCHAR(255),
	mime_type VARCHAR(100),
	created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

	CONSTRAINT fk_mail_attachments
	FOREIGN KEY (mail_id) REFERENCES mails(id)
	ON DELETE CASCADE
);
