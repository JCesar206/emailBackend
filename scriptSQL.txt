CREATE DATABASE correo_app
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_unicode_ci;

USE correo_app;

CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  email VARCHAR(100) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE mails (
  id INT AUTO_INCREMENT PRIMARY KEY,
  sender_id INT NOT NULL,
  receiver_email VARCHAR(100) NOT NULL,
  subject VARCHAR(150) NOT NULL,
  body TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_sender
    FOREIGN KEY (sender_id)
    REFERENCES users(id)
    ON DELETE CASCADE
);

CREATE TABLE mail_attachments (
	id INT AUTO_INCREMENT PRIMARY KEY,
	mail_id INT NOT NULL,
	filename VARCHAR(255) NOT NULL,
	original_name VARCHAR(255),
	mime_type VARCHAR(100),
	created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

	CONSTRAINT fk_mail_attachments
	FOREIGN KEY (mail_id) REFERENCES mails(id)
	ON DELETE CASCADE
);

ALTER TABLE mails
ADD COLUMN is_read TINYINT(1) DEFAULT 0;

CREATE TABLE folders (
	id INT AUTO_INCREMENT PRIMARY KEY,
	user_id INT NOT NULL,
	name VARCHAR(50) NOT NULL
);

ALTER TABLE mails 
ADD COLUMN folder_id INT NULL;
// Insertar usuarios d eprueba
INSERT INTO users (email, password) VALUES
('user1@test.com', '$2b$10$CwTycUXWue0Thq9StjUM0uJ8KX9GQF4iZ9erjRzCQXDpUe1koXSPG'),
('user2@test.com', '$2b$10$CwTycUXWue0Thq9StjUM0uJ8KX9GQF4iZ9erjRzCQXDpUe1koXSPG');
// Probar la inserci√≥n de usuarios
SELECT id, email FROM users;